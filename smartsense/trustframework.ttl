@prefix gx: <https://registry.lab.gaia-x.eu/development/api/trusted-shape-registry/v1/shapes/jsonld/trustframework#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

gx:ParticipantShape a sh:NodeShape ;
    sh:targetClass gx:Participant, gx:LegalParticipant ;
    sh:nodeKind sh:IRI .

# TODO: simplify with https://github.com/zazuko/rdf-validate-shacl/issues/41#issuecomment-745803630

gx:LegalParticipantShape a sh:NodeShape ;
    sh:targetClass gx:LegalParticipant ;
    sh:property [
        sh:path gx:legalRegistrationNumber ;
        sh:node gx:legalRegistrationNumberShape ;
        sh:minCount 1 ;
    ], [
        sh:path gx:parentOrganization ;
        sh:node gx:LegalParticipantShape ;
    ], [
        sh:path gx:subOrganization ;
        sh:node gx:LegalParticipantShape ;
    ], [
        sh:path gx:headquarterAddress ;
        sh:minCount 1 ;
        sh:node gx:PostalAddressShape ;
    ], [
        sh:path gx:legalAddress ;
        sh:minCount 1 ;
        sh:node gx:PostalAddressShape ;
    ] .

gx:legalRegistrationNumberShape a sh:NodeShape ;
    sh:targetClass gx:legalRegistrationNumber ;
    sh:message "At least one of taxID, vatID, EUID, EORI or leiCode must be defined." ;
    sh:property [
        sh:path gx:taxID ;
        sh:datatype xsd:string ;
        sh:minLength 3 ;
    ];
    sh:property [
        sh:path gx:EUID ;
        sh:datatype xsd:string ;
        sh:minLength 3 ;
    ];
    sh:property [
        sh:path gx:EORI ;
        sh:datatype xsd:string ;
        sh:minLength 3 ;
    ];
    sh:property [
        sh:path gx:vatID ;
        sh:datatype xsd:string ;
        sh:minLength 3 ;
    ];
    sh:property [
        sh:path gx:leiCode ;
        sh:datatype xsd:string ;
        sh:minLength 3 ;
    ];
    sh:or (
        [
            sh:path gx:taxID ;
            sh:minCount 1 ;
        ]
        [
            sh:path gx:EUID ;
            sh:minCount 1 ;
        ]
        [
            sh:path gx:EORI ;
            sh:minCount 1 ;
        ]
        [
            sh:path gx:vatID ;
            sh:minCount 1 ;
        ]
        [
            sh:path gx:leiCode ;
            sh:minCount 1 ;
        ]
    ) .

gx:PostalAddressShape a sh:NodeShape ;
    sh:targetClass gx:headquarterAddress, gx:legalAddress ;
    sh:property [
        sh:path gx:countrySubdivisionCode ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:pattern "^[a-zA-Z]{2}-(?:[a-zA-Z]{1,3}|[0-9]{1,3})$" ;
        sh:flags "i" ;
        sh:message "an ISO 3166-2 format value is expected." ;
    ] .

gx:GaiaXTermsAndConditionsShape a sh:NodeShape ;
    sh:targetClass gx:GaiaXTermsAndConditions;
    sh:property [
        sh:path gx:termsAndConditions ;
        sh:datatype xsd:string ;
        sh:minCount 1 ;
        sh:hasValue '''The PARTICIPANT signing the Self-Description agrees as follows:
- to update its descriptions about any changes, be it technical, organizational, or legal - especially but not limited to contractual in regards to the indicated attributes present in the descriptions.

The keypair used to sign Verifiable Credentials will be revoked where Gaia-X Association becomes aware of any inaccurate statements in regards to the claims which result in a non-compliance with the Trust Framework and policy rules defined in the Policy Rules and Labelling Document (PRLD).''' ;
    ] .

gx:DataAccountExportShape
    a              sh:NodeShape ;
    sh:targetClass gx:dataAccountExport ;
    sh:property    [ sh:path     gx:requestType ;
                     sh:datatype xsd:string ;
                     sh:name     "Request type" ;
                     sh:minCount 1 ;
                     sh:maxCount 1 ;
                     sh:in       ( "API" "email" "webform" "unregisteredLetter" "registeredLetter" "supportCenter" ) ] ;
    sh:property    [ sh:path        gx:accessType ;
                     sh:datatype    xsd:string ;
                     sh:name        "Access type" ;
                     sh:minCount    1 ;
                     sh:maxCount    1 ;
                     sh:description "type of data support: digital, physical." ;
                     sh:in          ( "digital" "physical" ) ] ;
    sh:property    [ sh:path     gx:formatType ;
                     sh:datatype xsd:string ;
                     sh:name     "Format type" ;
                     sh:minCount 1 ;
                     sh:maxCount 1 ;
                     sh:pattern  "^\\w+/[-+.\\w]+$" ;
                     sh:flags    "i" ;
                     sh:message  "type of Media Types (formerly known as MIME types) as defined by the IANA." ; ] .

gx:SOTermsAndConditionsShape
    a              sh:NodeShape ;
    sh:targetClass gx:SOTermsAndConditions ;
    sh:property    [ sh:path        gx:URL ;
                     sh:name        "URL" ;
                     sh:description "a resolvable link to document" ;
                     sh:minCount    1 ;
                     sh:maxCount    1 ;
                     sh:datatype    xsd:string ] ;
    sh:property    [ sh:path        gx:hash ;
                     sh:name        "hash" ;
                     sh:minCount    1 ;
                     sh:maxCount    1 ;
                     sh:description "sha256 hash of the above document." ;
                     sh:datatype    xsd:string ] .

gx:ServiceOfferingShape
    a              sh:NodeShape ;
    sh:targetClass gx:ServiceOffering ;
    sh:property    [ sh:path        gx:providedBy ;
                     sh:name        "provided by" ;
                     sh:description "a resolvable link to the participant self-description providing the service." ;
                     sh:minCount    1 ;
                     sh:maxCount    1 ;
                     sh:node gx:LegalParticipantShape ] ; # TODO add alternativePath to support all type of Participant
    sh:property    [ sh:path     gx:aggregationOf ;
                     sh:name     "aggregation of" ;
                     sh:description
                                 "a resolvable link to the resources self-description related to the service and that can exist independently of it." ;
                     sh:datatype xsd:string ] ;
    sh:property    [ sh:path     gx:dependsOn ;
                     sh:name     "depends on" ;
                     sh:description
                                 "a resolvable link to the service offering self-description related to the service and that can exist independently of it." ;
                     sh:datatype gx:ServiceOffering ] ;
    sh:property    [ sh:path     gx:termsAndConditions ;
                     sh:name     "terms & conditions" ;
                     sh:minCount 1 ;
                     sh:description
                                 "a resolvable link to the service offering self-description related to the service and that can exist independently of it." ;
                     sh:node gx:SOTermsAndConditionsShape ] ;
    sh:property    [ sh:path     gx:policy ;
                     sh:name     "policy" ;
                     sh:minCount 1 ;
                     sh:description
                                 "a list of policy expressed using a DSL (e.g., Rego or ODRL) (access control, throttling, usage, retention, …)." ;
                     sh:datatype xsd:string ] ;
    sh:property    [ sh:path        gx:dataProtectionRegime ;
                     sh:name        "data protection regime" ;
                     sh:description "a list of data protection regime" ;
                     sh:in          ( "GDPR2016" "LGPD2019" "PDPA2012" "CCPA2018" "VCDPA2021" ) ;
                     sh:message     "Refer to https://gaia-x.gitlab.io/policy-rules-committee/trust-framework/service_and_subclasses/#service-offering Personal Data Protection Regimes" ;
                     sh:datatype    xsd:string ] ;
    sh:property    [ sh:path        gx:dataAccountExport ;
                     sh:name        "data account export" ;
                     sh:minCount    1 ;
                     sh:description "list of methods to export data from your user’s account out of the service" ;
                     sh:node    gx:DataAccountExportShape ; ] ;
    sh:property    [ sh:path        gx:labelLevel ;
                     sh:name        "Label level" ;
                     sh:minCount    1 ;
                     sh:maxCount    1 ;
                     sh:description "a resolvable link to the service offering label self-description related to the service" ;
                     sh:node    gx:ServiceOfferingLabelShape ; ] .


gx:CriteriaEvidenceShape a sh:NodeShape ;
    sh:targetClass  gx:CriteriaEvidence ;
    sh:property [
        sh:path gx:website ;
        sh:name "Website" ;
        sh:description: "Link to website to complete evidance information";
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
    ] ;
    sh:property [
        sh:path gx:pdf ;
        sh:name "Attestation PDF" ;
        sh:description: "Link to attestation PDF to complete evidance information";
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
    ] ;
    sh:property [
        sh:path gx:vc ;
        sh:name "Verifiable Credential" ;
        sh:description: "Link to verifiable credential to complete evidance information";
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
    ] .

gx:CriteriaShape a sh:NodeShape ;
    sh:targetClass  gx:Criteria;
    sh:property [
        sh:path gx:response ;
        sh:name "Response" ;
        sh:in ("Confirm" "Deny" "Not applicable" );
        sh:minCount 1 ;
        sh:maxCount 1 ;
    ] ;
    sh:property [
        sh:path gx:reason ;
        sh:name "Reasoning" ;
        sh:datatype xsd:string ;
        sh:maxCount 1 ;
    ] ;
    sh:property [
        sh:path gx:evedince ;
        sh:name "Evidence" ;
        sh:maxCount 1 ;
        sh:node    gx:CriteriaEvidenceShape ;
    ] .

gx:ServiceOfferingCriteriaShape a sh:NodeShape ;
    sh:targetClass gx:ServiceOfferingCriteria ;
    sh:property [
        sh:path "P1.1.1" ;
        sh:name "Criterion P1.1.1" ;
        sh:description "The Provider shall offer the ability to establish a legally binding act. This legally binding act shall be documented." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.1.2" ;
        sh:name "Criterion P1.1.2" ;
        sh:description "The Provider shall have an option for each legally binding act to be governed by EU/EEA/Member State law." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.1.3" ;
        sh:name "Criterion P1.1.3" ;
        sh:description "The Provider shall clearly identify for which parties the legal act is binding." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.1.4" ;
        sh:name "Criterion P1.1.4" ;
        sh:description "The Provider shall ensure that the legally binding act covers the entire provision of the Service Offering." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.2.1" ;
        sh:name "Criterion P1.2.1" ;
        sh:description "The Provider shall ensure there are specific provisions regarding service interruptions and business continuity (e.g., by means of a service level agreement), Provider’s bankruptcy or any other reason by which the Provider may cease to exist in law." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.2.2" ;
        sh:name "Criterion P1.2.2" ;
        sh:description "The Provider shall ensure there are provisions governing the rights of the parties to use the service and any Customer Data therein." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.2.3" ;
        sh:name "Criterion P1.2.3" ;
        sh:description "The Provider shall ensure there are provisions governing changes, regardless of their kind." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.2.4" ;
        sh:name "Criterion P1.2.4" ;
        sh:description "The Provider shall ensure there are provisions governing aspects regarding copyright or any other intellectual property rights." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.2.5" ;
        sh:name "Criterion P1.2.5" ;
        sh:description "The Provider shall declare the location of the processing of any Customer Data at urban area level." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.2.6" ;
        sh:name "Criterion P1.2.6" ;
        sh:description "The Provider shall explain how information about subcontractors and related Customer Data localization will be communicated." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.2.7" ;
        sh:name "Criterion P1.2.7" ;
        sh:description "The Provider shall communicate to the Customer where the applicable jurisdiction(s) of subcontractors will be." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.2.8" ;
        sh:name "Criterion P1.2.8" ;
        sh:description "The Provider shall include in the contract the contact details where Customer may address any queries regarding the Service Offering and the contract." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.2.9" ;
        sh:name "Criterion P1.2.9" ;
        sh:description "The Provider shall adopt the Gaia-X Trust Framework, by which Customers may verify Provider’s Service Offering." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.2.10" ;
        sh:name "Criterion P1.2.10" ;
        sh:description "The Provider shall provide transparency on the environmental impact of the Service Offering provided" ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.3.1" ;
        sh:name "Criterion P1.3.1" ;
        sh:description "Service Offering shall include a policy using a common Domain-Specific Language (DSL) to describe Permissions, Requirements and Constraints." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.3.2" ;
        sh:name "Criterion P1.3.2" ;
        sh:description "Service Offering requires being operated by Service Offering Provider with a verified identity." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.3.3" ;
        sh:name "Criterion P1.3.3" ;
        sh:description "Service Offering must provide a conformant self-description." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.3.4" ;
        sh:name "Criterion P1.3.4" ;
        sh:description "Self-Description attributes need to be consistent across linked Self-Descriptions." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.3.5" ;
        sh:name "Criterion P1.3.5" ;
        sh:description "The Provider shall ensure that the Consumer uses a verified identity provided by the Federator." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P2.1.1" ;
        sh:name "Criterion P2.1.1" ;
        sh:description "The Provider shall offer the ability to establish a contract under Union or EU/EEA/Member State law and specifically addressing GDPR requirements." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P1.1.1" ;
        sh:name "Criterion P2.1.2" ;
        sh:description "The Provider shall define the roles and responsibilities of each party." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P2.1.3" ;
        sh:name "Criterion P2.1.3" ;
        sh:description "The Provider shall clearly define the technical and organizational measures in accordance with the roles and responsibilities of the parties, including an adequate level of detail." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P2.2.1" ;
        sh:name "Criterion P2.2.1" ;
        sh:description "The Provider shall be ultimately bound to instructions of the Customer." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P2.2.2" ;
        sh:name "Criterion P2.2.2" ;
        sh:description "The Provider shall clearly define how Customer may instruct, including by electronic means such as configuration tools or APIs." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P2.2.3" ;
        sh:name "Criterion P2.2.3" ;
        sh:description "The Provider shall clearly define if and to which extent third country transfer will take place." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P2.2.4" ;
        sh:name "Criterion P2.2.4" ;
        sh:description "The Provider shall clearly define if and to the extent third country transfers will take place, and by which means of Chapter V GDPR these transfers will be protected." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P2.2.5" ;
        sh:name "Criterion P2.2.5" ;
        sh:description "The Provider shall clearly define if and to which extent sub-processors will be involved." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P2.2.6" ;
        sh:name "Criterion P2.2.6" ;
        sh:description "The Provider shall clearly define if and to the extent sub-processors will be involved, and the measures that are in place regarding sub-processors management." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P2.2.7" ;
        sh:name "Criterion P2.2.7" ;
        sh:description "The Provider shall define the audit rights for the Customer." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P2.3.1" ;
        sh:name "Criterion P2.3.1" ;
        sh:description "In case of a joint controllership, the Provider shall ensure an arrangement pursuant to Art. 26 (1) GDPR is in place." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P2.3.2" ;
        sh:name "Criterion P2.3.2" ;
        sh:description "In case of a joint controllership, at a minimum, the Provider shall ensure that the very essence of such agreement is communicated to data subjects." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P2.3.3" ;
        sh:name "Criterion P2.3.3" ;
        sh:description "In case of a joint controllership, the Provider shall publish a point of contact for data subjects." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P3.1.1" ;
        sh:name "Criterion P3.1.1" ;
        sh:description "Organization of information security: Plan, implement, maintain and continuously improve the information security framework within the organisation." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P3.1.2" ;
        sh:name "Criterion P3.1.2" ;
        sh:description "Information Security Policies: Provide a global information security policy, derived into policies and procedures regarding security requirements and to support business requirements." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P3.1.3" ;
        sh:name "Criterion P3.1.3" ;
        sh:description "Risk Management: Ensure that risks related to information security are properly identified, assessed, and treated, and that the residual risk is acceptable to the CSP." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P3.1.4" ;
        sh:name "Criterion P3.1.4" ;
        sh:description "Human Resources: Ensure that employees understand their responsibilities, are aware of their responsibilities with regard to information security, and that the organisation’s assets are protected in the event of changes in responsibilities or termination." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P3.1.5" ;
        sh:name "Criterion P3.1.5" ;
        sh:description "Asset Management: Identify the organisation’s own assets and ensure an appropriate level of protection throughout their lifecycle." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P3.1.6" ;
        sh:name "Criterion P3.1.6" ;
        sh:description "Physical Security: Prevent unauthorised physical access and protect against theft, damage, loss and outage of operations." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape 
    ] ;
    sh:property [
        sh:path "P3.1.7" ;
        sh:name "Criterion P3.1.7" ;
        sh:description "Operational Security: Ensure proper and regular operation, including appropriate measures for planning and monitoring capacity, protection against malware, logging and monitoring events, and dealing with vulnerabilities, malfunctions and failures." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P3.1.8" ;
        sh:name "Criterion P3.1.8" ;
        sh:description "Identity, Authentication and access control management: Limit access to information and information processing facilities." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape 
    ] ;
    sh:property [
        sh:path "P3.1.9" ;
        sh:name "Criterion P3.1.9" ;
        sh:description "Cryptography and Key management: Ensure appropriate and effective use of cryptography to protect the confidentiality, authenticity or integrity of information." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P3.1.10" ;
        sh:name "Criterion P3.1.10" ;
        sh:description "Communication Security: Ensure the protection of information in networks and the corresponding information processing systems." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape 
    ] ;
    sh:property [
        sh:path "P3.1.11" ;
        sh:name "Criterion P3.1.11" ;
        sh:description "Portability and Interoperability: The CSP shall provide a means by which a customer can obtain their stored customer data, and provide documentation on how (where appropriate, through documented API’s) the CSC can obtain the stored data at the end of the contractual relationship and shall document how the data will be securely deleted from the Cloud Service Provider in what timeframe." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P3.1.12" ;
        sh:name "Criterion P3.1.12" ;
        sh:description "Change and Configuration Management: Ensure that changes and configuration actions to information systems guarantee the security of the delivered cloud service." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape 
    ] ;
    sh:property [
        sh:path "P3.1.13" ;
        sh:name "Criterion P3.1.13" ;
        sh:description "Development of Information systems: Ensure information security in the development cycle of information systems." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P3.1.14" ;
        sh:name "Criterion P3.1.14" ;
        sh:description "Procurement Management: Ensure the protection of information that suppliers of the CSP can access and monitor the agreed services and security requirements." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P3.1.15" ;
        sh:name "Criterion P3.1.15" ;
        sh:description "Incident Management: Ensure a consistent and comprehensive approach to the capture, assessment, communication and escalation of security incidents." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P3.1.16" ;
        sh:name "Criterion P3.1.16" ;
        sh:description "Business Continuity: Plan, implement, maintain and test procedures and measures for business continuity and emergency management." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P3.1.17" ;
        sh:name "Criterion P3.1.17" ;
        sh:description "Compliance: Avoid non-compliance with legal, regulatory, self-imposed or contractual information security and compliance requirements." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P3.1.18" ;
        sh:name "Criterion P3.1.18" ;
        sh:description "User documentation: Provide up-to-date information on the secure configuration and known vulnerabilities of the cloud service for cloud customers." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P3.1.19" ;
        sh:name "Criterion P3.1.19" ;
        sh:description "Dealing with information requests from government agencies: Ensure appropriate handling of government investigation requests for legal review, information to cloud customers, and limitation of access to or disclosure of Customer Data." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P3.1.20" ;
        sh:name "Criterion P3.1.20" ;
        sh:description "Product safety and security: Provide appropriate mechanisms for cloud customers to enable product safety and security." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P4.1.1" ;
        sh:name "Criterion P4.1.1" ;
        sh:description "The Provider shall implement practices for facilitating the switching of Providers and the porting of Customer Data in a structured, commonly used and machine-readable format including open standard formats where required or requested by the Customer." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape 
    ] ;
    sh:property [
        sh:path "P4.1.2" ;
        sh:name "Criterion P4.1.2" ;
        sh:description "The Provider shall ensure pre-contractual information exists, with sufficiently detailed, clear and transparent information regarding the processes of Customer Data portability, technical requirements, timeframes and charges that apply in case a professional user wants to switch to another Provider or port Customer Data back to its own IT systems." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape 
    ] ;
    sh:property [
        sh:path "P5.1.1" ;
        sh:name "Criterion P5.1.1" ;
        sh:description "For Label Level 2, the Provider shall provide the option that all Customer Data are processed and stored exclusively in EU/EEA." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P5.1.2" ;
        sh:name "Criterion P5.1.2" ;
        sh:description "For Label Level 3, the Provider shall process and store all Customer Data exclusively in the EU/EEA." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P5.1.3" ;
        sh:name "Criterion P5.1.3" ;
        sh:description "For Label Level 3, where the Provider or subcontractor is subject to legal obligations to transmit or disclose Customer Data on the basis of a non-EU/EEA statutory order, the Provider shall have verified safeguards in place to ensure that any access request is compliant with EU/EEA/Member State law." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P5.1.4" ;
        sh:name "Criterion P5.1.4" ;
        sh:description "For Label Level 3, the Provider’s registered head office, headquarters and main establishment shall be established in a Member State of the EU/EEA." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P5.1.5" ;
        sh:name "Criterion P5.1.5" ;
        sh:description "For Label Level 3, Shareholders in the Provider, whose registered head office, headquarters and main establishment are not established in a Member State of the EU/EEA shall not, directly or indirectly, individually or jointly, hold control of the CSP. Control is defined as the ability of a natural or legal person to exercise decisive influence directly or indirectly on the CSP through one or more intermediate entities, de jure or de facto. (cf. Council Regulation No 139/2004 and Commission Consolidated Jurisdictional Notice under Council Regulation (EC) No 139/2004 for illustrations of decisive control)." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P5.1.6" ;
        sh:name "Criterion P5.1.6" ;
        sh:description "For Label Level 3, in the event of recourse by the Provider, in the context of the services provided to the Customer, to the services of a third-party company - including a subcontractor - whose registered head office, headquarters and main establishment is outside of the European Union or who is owned or controlled directly or indirectly by another third-party company registered outside the EU/EEA, the third-party company shall have no access over the Customer Data nor access and identity management for the services provided to the Customer. The Provider, including any of its sub-processor, shall push back any request received from non-European authorities to obtain communication of Customer Data relating to European Customers, except if request is made in execution of a court judgment or order that is valid and compliant under Union law and applicable Member States law as provided by Article 48 GDPR." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P5.1.7" ;
        sh:name "Criterion P5.1.7" ;
        sh:description "For Label Level 3, the Provider must maintain continuous operating autonomy for all or part of the services it provides. The concept of operating autonomy shall be understood as the ability to maintain the provision of the cloud computing service by drawing on the provider’s own skills or by using adequate alternatives" ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape ;
    ] ;
    sh:property [
        sh:path "P5.2.1" ;
        sh:name "Criterion P5.2.1" ;
        sh:description "The Provider shall not access Customer Data unless authorized by the Customer or when the access is in accordance with EU/EEA/Member State law." ;
        sh:maxCount 1 ;
        sh:minCount 1 ;
        sh:node    gx:CriteriaShape 
    ] .


gx:ServiceOfferingLabelShape  a sh:NodeShape ;
  sh:targetClass gx:ServiceOfferingLabel ;
  sh:property [
    sh:path gx:labelLevel ;
    sh:name "Label level" ;
    sh:description "Label level of the service" ;
    sh:in ("BC" "L1" "L2" "L3" );
    sh:minCount 1 ;
    sh:maxCount 1 ;
  ] ;
  sh:property [
    sh:path gx:assignedTo ;
    sh:name "Assigned to" ;
    sh:description "a resolvable link to the service offering self-description to which label level is assigned to." ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:node gx:ServiceOfferingShape
  ] ;
  sh:property [
    sh:path gx:criteria ;
    sh:name "Criteria" ;
    sh:description "Gaia-X Policy Rules and Labelling Criteria for Providers" ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:node gx:ServiceOfferingCriteriaShape
  ] .


gx:NewPostalAddressShape a sh:NodeShape ;
  sh:targetClass gx:locationAddress ;
  sh:property [
    sh:path gx:countryCode ;
    sh:name "Country code" ;
    sh:description "An ISO 3166-2 format value is expected." ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:pattern "^[a-zA-Z]{2}-(?:[a-zA-Z]{1,3}|[0-9]{1,3})$" ;
    sh:flags "i" ;
    sh:message "An ISO 3166-2 format value is expected."
  ] .

gx:LocationShape a sh:NodeShape ;
  sh:targetClass gx:location ;
  sh:property [
    sh:path gx:gps ;
    sh:name "GPS" ;
    sh:description "A physical GPS value in ISO 6709:2008/Cor 1:2009 format." ;
    sh:datatype xsd:string ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:message "A physical GPS value in ISO 6709:2008/Cor 1:2009 format is expected"
  ] .

gx:PhysicalResourceShape a sh:NodeShape ;
  sh:targetClass gx:PhysicalResource ;
  sh:property [
    sh:path gx:name ;
    sh:name "Name" ;
    sh:description "A human readable name of the data resource" ;
    sh:datatype xsd:string ;
    sh:order 0 ;
    sh:minCount 0 ;
    sh:maxCount 1
  ],
  [
    sh:path gx:description ;
    sh:name "Description" ;
    sh:description "A free text description of the data resource" ;
    sh:datatype xsd:string ;
    sh:order 1 ;
    sh:minCount 0 ;
    sh:maxCount 1
  ],
  [
    sh:path gx:aggregationOf ;
    sh:name "Aggregation of" ;
    sh:description "resources related to the resource and that can exist independently of it." ;
    sh:or (
            [
              sh:node gx:PhysicalResourceShape ;
            ]
            [
              sh:node gx:VirtualDataResourceShape ;
            ]
            [
              sh:node  gx:VirtualSoftwareResourceShape
            ]
		); 
    sh:order 2 ;
    sh:minCount 0
  ],
  [
    sh:path gx:maintainedBy ;
    sh:name "Maintained by" ;
    sh:description "a list of resolvable link to the participants maintaining the resource in operational condition and thus having physical access to it." ;
    sh:node gx:LegalParticipantShape;
    sh:order 3 ;
    sh:minCount 1
  ],
  [
    sh:path gx:ownedBy ;
    sh:name "Owned by" ;
    sh:description "a list of resolvable link to the participants owning the resource." ;
    sh:node gx:LegalParticipantShape;
    sh:order 4 ;
    sh:minCount 0
  ],
  [
    sh:path gx:manufacturedBy ;
    sh:name "Manufactured by" ;
    sh:description "a list of resolvable link to the participants manufacturing the resource." ;
    sh:node gx:LegalParticipantShape;
    sh:order 5 ;
    sh:minCount 0
  ],
  [
    sh:path gx:locationAddress ;
    sh:description "a list of physical locations in ISO 3166-2 alpha2, alpha-3 or numeric format." ;
    sh:node gx:NewPostalAddressShape;
    sh:minCount 1 ;
    sh:order 6
  ],
  [
    sh:path gx:location ;
    sh:description "a list of physical GPS in ISO 6709:2008/Cor 1:2009 format." ;
    sh:node gx:LocationShape;
    sh:minCount 0 ;
    sh:order 7 
  ] .

gx:VirtualDataResourceShape a sh:NodeShape ;
  sh:targetClass gx:VirtualDataResource ;
  sh:property [
        sh:path gx:name ;
        sh:name "Name" ;
        sh:description "A human readable name of the data resource" ;
        sh:datatype xsd:string ;
        sh:order 0 ;
        sh:minCount 0 ;
        sh:maxCount 1
    ],
    [
        sh:path gx:description ;
        sh:name "Description" ;
        sh:description "A free text description of the data resource" ;
        sh:datatype xsd:string ;
        sh:order 1 ;
        sh:minCount 0 ;
        sh:maxCount 1
    ],
    [
        sh:path gx:aggregationOf ;
        sh:name "Aggregation of" ;
        sh:description "Resources related to the resource and that can exist independently of it." ;
        sh:or (
            [
                sh:node gx:PhysicalResourceShape ;
            ]
            [
                sh:node gx:VirtualDataResourceShape ;
            ]
            [
                sh:node  gx:VirtualSoftwareResourceShape
            ]
        ); 
        sh:order 2 ;
        sh:minCount 0
    ],
    [
        sh:path gx:copyrightOwnedBy ;
        sh:name "Copyright owned by" ;
        sh:description "A list of copyright owners either as a free form string or participant URIs from which Self-Descriptions can be retrieved. A copyright owner is a person or organization that has the right to exploit the resource. Copyright owner does not necessarily refer to the author of the resource, who is a natural person and may differ from copyright owner." ;
        sh:or (
                [
                    sh:datatype xsd:string ;
                ]
                [
                    sh:node gx:LegalParticipantShape ;
                ]
            );
        sh:order 3 ;
        sh:minCount 1
    ],
    [
        sh:path gx:license ;
        sh:name "License" ;
        sh:description "A list of SPDX identifiers or URL to document" ;
        sh:datatype xsd:string ;
        sh:order 4 ;
        sh:minCount 1
    ],
    [
        sh:path gx:policy ;
        sh:name "Policy" ;
        sh:description "A list of policy expressed using a DSL (e.g., Rego or ODRL) (access control, throttling, usage, retention, …)" ;
        sh:datatype xsd:string ;
        sh:order 5 ;
        sh:minCount 1
    ],
    [
        sh:path gx:producedBy ;
        sh:name "Produced by" ;
        sh:description "A resolvable link to the participant self-description legally enabling the data usage" ;
        sh:node gx:LegalParticipantShape ;
        sh:order 6 ;
        sh:minCount 1;
        sh:maxCount 1
    ],
    [
        sh:path gx:exposedThrough ;
        sh:name "Exposed through" ;
        sh:description "A resolvable link to the data exchange component that exposes the data resource." ;
        sh:datatype xsd:string ;
        sh:order 7 ;
        sh:minCount 1
    ],
    [
        sh:path gx:obsoleteDateTime ;
        sh:name "Obsolete Date Time" ;
        sh:description "Date time in ISO 8601 format after which data is obsolete." ;
        sh:datatype xsd:string ;
        sh:order 8;
        sh:minCount 0;
        sh:maxCount 1
    ],[
        sh:path gx:expirationDateTime ;
        sh:name "Expiration Date Time" ;
        sh:description "Date time in ISO 8601 format after which data is expired and shall be deleted." ;
        sh:datatype xsd:string ;
        sh:order 9;
        sh:minCount 0;
        sh:maxCount 1
    ],
    [
        sh:path gx:containsPII ;
        sh:name "Produced by" ;
        sh:description "Boolean determined by Participant owning the Data Resource" ;
        sh:datatype xsd:boolean ;
        sh:order 10 ;
        sh:minCount 1;
        sh:maxCount 1
    ],
    [
        sh:path gx:legalBasis ;
        sh:name "Legal basis" ;
        sh:description "One of the reasons as detailed in the identified Personal Data Protection Regimes, such as [GDPR2018]. Potential Legal Bases can be article 6, article 7 or article 9. It shall be expressed as a string matching 6.1.[a-f], 6.1.4, 7 or 9.2.[a-j]." ;
        sh:datatype xsd:string ;
        sh:in ("6.1.[a-f]" "6.1.4" "7" "9.2.[a-j]" );
        sh:order 11 ;
        sh:minCount 0;
        sh:maxCount 1
        
    ],
    [
        sh:path gx:dataProtectionContact ;
        sh:name "Data protection contact" ;
        sh:description "Means to address distinct personal data protection related questions related to the Data Source, either an URL pointing to a contact form or an emailaddress." ;
        sh:datatype xsd:string ;
        sh:order 12 ;
        sh:minCount 0;
        sh:maxCount 1  
    ]; .

gx:VirtualSoftwareResourceShape a sh:NodeShape ;
  sh:targetClass gx:VirtualSoftwareResource ;
  sh:property [
    sh:path gx:name ;
    sh:name "Name" ;
    sh:description "A human readable name of the data resource" ;
    sh:datatype xsd:string ;
    sh:order 0 ;
    sh:minCount 0 ;
    sh:maxCount 1
  ],
  [
    sh:path gx:description ;
    sh:name "Description" ;
    sh:description "A free text description of the data resource" ;
    sh:datatype xsd:string ;
    sh:order 1 ;
    sh:minCount 0 ;
    sh:maxCount 1
  ],
  [
    sh:path gx:aggregationOf ;
    sh:name "Aggregation of" ;
    sh:description "Resources related to the resource and that can exist independently of it." ;
    sh:or (
            [
                sh:node gx:PhysicalResourceShape ;
            ]
            [
                sh:node gx:VirtualDataResourceShape ;
            ]
            [
                sh:node  gx:VirtualSoftwareResourceShape
            ]
        ); 
    sh:order 2 ;
    sh:minCount 0
  ],
  [
    sh:path gx:copyrightOwnedBy ;
    sh:name "Copyright owned by" ;
    sh:description "A list of copyright owners either as a free form string or participant URIs from which Self-Descriptions can be retrieved. A copyright owner is a person or organization that has the right to exploit the resource. Copyright owner does not necessarily refer to the author of the resource, who is a natural person and may differ from copyright owner." ;
    sh:or (
			[
				sh:datatype xsd:string ;
			]
			[
                sh:node gx:LegalParticipantShape ;
			]
		);
    sh:order 3 ;
    sh:minCount 1
  ],
  [
    sh:path gx:license ;
    sh:name "License" ;
    sh:description "A list of SPDX identifiers or URL to document" ;
    sh:datatype xsd:string ;
    sh:order 4 ;
    sh:minCount 1
  ],
  [
    sh:path gx:policy ;
    sh:name "Policy" ;
    sh:description "A list of policy expressed using a DSL (e.g., Rego or ODRL) (access control, throttling, usage, retention, …)" ;
    sh:datatype xsd:string ;
    sh:order 5 ;
    sh:minCount 1
  ] .
  

